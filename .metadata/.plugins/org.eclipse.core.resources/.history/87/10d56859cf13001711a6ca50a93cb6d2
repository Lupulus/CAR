

public class Configuration {
	public static final String CONFIG_FILE = "systems.json";

	private static GlobalConfiguration config;

	
	/** 
	 * Permet de récupérer une configuration globale à partir d'un fichier JSON.
	 * @return La référence vers une configuration globale.
	 */
	public static synchronized GlobalConfiguration getConfig() {
		
		
		if (config == null) {
			// load from file
			try (FileReader reader = new FileReader(CONFIG_FILE)) {
				config = new Gson().fromJson(reader, GlobalConfiguration.class);
			} catch (Exception e) {
				Log.error("Config file not found or not valid. Generating default configuration... ");
				config = defaultConfig();
				
				try (FileWriter writer = new FileWriter(CONFIG_FILE, false)) {
					new GsonBuilder().serializeNulls().setPrettyPrinting().create().toJson(config, writer);
					
				} catch (Exception e1) {
					Log.error("Error while saving the config file: " + e1);
				}
			}
		}
		return config;
}
}
