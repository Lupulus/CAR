package Command;

import java.io.File;
import java.io.IOException;
import java.nio.file.DirectoryNotEmptyException;
import java.nio.file.Files;
import java.nio.file.NoSuchFileException;

import Request.FtpRequest;

public class CommandDele extends Command{
	
	public CommandDele(FtpRequest ftp){
		super(ftp);
	}
	
	@Override 
	public boolean process(String arg){
		
			File target = getFileFromArgument(ftp, arg);
			
			if (target.equals(ftp.getCanonicalRootDirectoryFile())) {
				ftp.sendResponse(new Response550FileError("Can't remove root directory"));
				return;
			}
			
			try {
			    Files.delete(target.toPath());
			    ftp.sendResponse(new Response250FileActionCompleted("File deleted successfully"));
			} catch (NoSuchFileException e) {
				ftp.sendResponse(new Response550FileError("File not found"));
			} catch (DirectoryNotEmptyException e) {
				ftp.sendResponse(new Response550FileError("Directory not empty"));
			} catch (IOException e) {
				ftp.sendResponse(new Response550FileError("Can't remove file: "+e.getMessage()));
	}
	}
}
